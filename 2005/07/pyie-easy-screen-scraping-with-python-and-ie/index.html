<!DOCTYPE html>
<!--[if IE 6]>
<html id="ie6" dir="ltr" lang="en-US">
<![endif]-->
<!--[if IE 7]>
<html id="ie7" dir="ltr" lang="en-US">
<![endif]-->
<!--[if IE 8]>
<html id="ie8" dir="ltr" lang="en-US">
<![endif]-->
<!--[if !(IE 6) | !(IE 7) | !(IE 8)  ]><!-->
<html dir="ltr" lang="en-US">
<!--<![endif]-->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" >
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width" />
<title>PyIE: Easy Screen-Scraping with Python and IE | ohadpr</title>
<link rel="profile" href="http://gmpg.org/xfn/11" />
<link rel="stylesheet" type="text/css" media="all" href="../../../wp-content/themes/twentyeleven/style.css" />
<link rel="pingback" href="../../../xmlrpc.php.html" />
<!--[if lt IE 9]>
<script src="../../../wp-content/themes/twentyeleven/js/html5.js" type="text/javascript"></script>
<![endif]-->
<link rel="alternate" type="application/rss+xml" title="ohadpr &raquo; Feed" href="../../../feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="ohadpr &raquo; Comments Feed" href="../../../comments/feed/index.html" />
<link rel="alternate" type="application/rss+xml" title="ohadpr &raquo; PyIE: Easy Screen-Scraping with Python and IE Comments Feed" href="feed/index.html" />
<link rel="EditURI" type="application/rsd+xml" title="RSD" href="../../../xmlrpc-rsd.php.html" />
<link rel="wlwmanifest" type="application/wlwmanifest+xml" href="../../../wp-includes/wlwmanifest.xml" /> 
<link rel='prev' title='Local Process Information' href='../../06/local-process-information/index.html' />
<link rel='next' title='Hacking the EasyHotel TV (incomplete)' href='../../09/hacking-the-easyhotel-tv-incomplete/index.html' />
<meta name="generator" content="WordPress 3.3.1" />
<link rel='canonical' href='index.html' />
<link rel='shortlink' href='../../../index-p=13.html' />
</head>

<body class="single single-post postid-13 single-format-standard singular two-column right-sidebar">
<div id="page" class="hfeed">
	<header id="branding" role="banner">
			<hgroup>
				<h1 id="site-title"><span><a href="../../../index.html" title="ohadpr" rel="home">ohadpr</a></span></h1>
				<h2 id="site-description">ideas, hacks and stuff</h2>
			</hgroup>

			
								<form method="get" id="searchform" action="http://ohadpr.com/">
		<label for="s" class="assistive-text">Search</label>
		<input type="text" class="field" name="s" id="s" placeholder="Search" />
		<input type="submit" class="submit" name="submit" id="searchsubmit" value="Search" />
	</form>
			
			<nav id="access" role="navigation">
				<h3 class="assistive-text">Main menu</h3>
								<div class="skip-link"><a class="assistive-text" href="#content" title="Skip to primary content">Skip to primary content</a></div>
				<div class="skip-link"><a class="assistive-text" href="#secondary" title="Skip to secondary content">Skip to secondary content</a></div>
								<div class="menu"><ul><li ><a href="../../../index.html" title="Home">Home</a></li><li class="page_item page-item-2"><a href="../../../about/index.html">About</a></li><li class="page_item page-item-164"><a href="../../../privacy-policy/index.html">Privacy Policy</a></li><li class="page_item page-item-223"><a href="../../../sitemap/index.html">sitemap</a></li></ul></div>
			</nav><!-- #access -->
	</header><!-- #branding -->


	<div id="main">
		<div id="primary">
			<div id="content" role="main">

				
					<nav id="nav-single">
						<h3 class="assistive-text">Post navigation</h3>
						<span class="nav-previous"><a href="../../06/local-process-information/index.html" rel="prev"><span class="meta-nav">&larr;</span> Previous</a></span>
						<span class="nav-next"><a href="../../09/hacking-the-easyhotel-tv-incomplete/index.html" rel="next">Next <span class="meta-nav">&rarr;</span></a></span>
					</nav><!-- #nav-single -->

					
<article id="post-13" class="post-13 post type-post status-publish format-standard hentry">
	<header class="entry-header">
		<h1 class="entry-title">PyIE: Easy Screen-Scraping with Python and IE</h1>

				<div class="entry-meta">
			<span class="sep">Posted on </span><a href="index.html" title="2:31 PM" rel="bookmark"><time class="entry-date" datetime="2005-07-26T14:31:00+00:00" pubdate>July 26, 2005</time></a><span class="by-author"> <span class="sep"> by </span> <span class="author vcard"><a class="url fn n" href="../../../author/ohad/index.html" title="View all posts by ohad" rel="author">ohad</a></span></span>		</div><!-- .entry-meta -->
			</header><!-- .entry-header -->

	<div class="entry-content">
		<p>I always like it when information I&#8217;m interested in just flows over to me.
<div style="text-align: center;">
<div style="text-align: left;"><span style="font-size:100%;"><span style="font-style: italic;"><br /></span>The first thing I did about this was start sending myself daily reports about my investment-account. I wrote a script that logged into the bank, fetched the info I wanted, and spat it out. A simple batch file was all it took to pipe this into another tool that simply sms&#8217;s the data over to me. This essentialy makes any worthy piece of data instantly deliverable to me wherever I am.</p>
<p><span style="color: rgb(0, 153, 0);">This just sound like you&#8217;re typical Matrix-hackerish style paragraph, but if you&#8217;re a moderate computer programmer, the next few paragraphs will clear it all up <img src='../../../wp-includes/images/smilies/icon_wink.gif' alt=';-)' class='wp-smiley' /> <br />If you&#8217;re not a programmer, The Matrix stuff is comming in masses.</p>
<p></span></span><br />
<blockquote><b>Screen scraping</b> is the act of capturing data from a system or program by capturing and interpreting the contents of some display that is not actually intended for data transport or inspection by programs</p></blockquote>
<div style="text-align: center;"><span style="font-size:85%;"><span style="font-style: italic;">source: </span><a style="font-style: italic;" href="http://en.wikipedia.org/wiki/Screen_scraping">wikipedia</a></span></div>
<p>  <span style="font-size:100%;"><br />The first thing you&#8217;ll want when you&#8217;re scraping for data is an easy way to control and fetch data from, let&#8217;s say, a browser.</p>
<p>I picked IE. I know it sucks but it&#8217;s easy to automate.</p>
<p>Anyways, any web-page is easily accesible through what&#8217;s called the <a href="http://en.wikipedia.org/wiki/Document_Object_Model">DOM</a>. To find out where in the DOM lyes the piece of data you&#8217;re after, use the priceless <a href="http://www.ieinspector.com/dominspector/index.html">DOM-Inspector</a>, a click here and a click there and you suddenly know that you&#8217;re daily loss/gain is neatly located at :<br /><span style="color: rgb(51, 102, 255);">document.frames.middle.document.frames.IFrames.document.<br />getElementById(&#8220;QTable2&#8243;).childNodes.item(0).childNodes.<br />item(0).childNodes.item(0).childNodes.item(0).childNodes.<br />item(2).innertext<span style="color: rgb(51, 0, 51);"><br />I would have never guessed this myself.</p>
<p>Now how do we automate all this process ? I mean we need to load up the page, fill in the form with our username/password, click &#8216;login&#8217;, click a few more buttons, fetch data, etc&#8230;<br />This is where Python + win32com + PyIE come to the rescue.</p>
<p>Python is fun and easy for scripting. PyIE is a small component I&#8217;ve written that simply loads up an invisible IE page (or visible if you want to debug stuff), and just does whatever you tell it to do. It handles lots of annoying issues like &#8216;click here, now wait for the stuff to come up&#8217;. Most components I tried to use required you to manually timeout the requests and handle things yourself, which is tiresome.</p>
<p><span style="font-weight: bold;">PyIE solves almost all of the tedious work of timing, error-handling and stuff like that.</span></p>
<p>PyIE provides a single method that safely fetches data or fills forms with your data, and is thus called <span style="font-style: italic; color: rgb(51, 51, 255);">safely</span>.</p>
<p>Download: <a href="../../../files/PyIE.py">PyIE.py</a><br />Examples: <a href="../../../files/send_sms.py">send_sms.py</a> (send an SMS in IL-Orange), <a href="../../../files/statcounter.py">stat_counter.py</a> (fetch info from your account at statcounter).</p>
<p>The two examples are most likely outdated (that&#8217;s the bad thing about screen-scraping), but use them to learn how to use PyIE.</p>
<p>Did I mention Python is beautiful ?<br /></span></span></span></div>
</div>
			</div><!-- .entry-content -->

	<footer class="entry-meta">
		This entry was posted in <a href="../../../category/index.html" title="View all posts in " rel="category tag"></a> by <a href="../../../author/ohad/index.html">ohad</a>. Bookmark the <a href="index.html" title="Permalink to PyIE: Easy Screen-Scraping with Python and IE" rel="bookmark">permalink</a>.		
			</footer><!-- .entry-meta -->
</article><!-- #post-13 -->

						<div id="comments">
	
	
			<h2 id="comments-title">
			3 thoughts on &ldquo;<span>PyIE: Easy Screen-Scraping with Python and IE</span>&rdquo;		</h2>

		
		<ol class="commentlist">
				<li class="comment even thread-even depth-1" id="li-comment-13">
		<article id="comment-13" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=68' class='avatar avatar-68 photo avatar-default' height='68' width='68' /><span class="fn">grebulon</span> on <a href="comment-page-1/index.html#comment-13"><time pubdate datetime="2005-07-27T03:39:00+00:00">July 27, 2005 at 3:39 AM</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>Ohad, you are priceless</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li>
	<li class="comment odd alt thread-odd thread-alt depth-1" id="li-comment-18">
		<article id="comment-18" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=68' class='avatar avatar-68 photo avatar-default' height='68' width='68' /><span class="fn">YanivG</span> on <a href="comment-page-1/index.html#comment-18"><time pubdate datetime="2005-10-20T18:02:00+00:00">October 20, 2005 at 6:02 PM</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>ohad &#8211; good stuff, the IE DOM-Inspector is cool!</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li>
	<li class="comment even thread-even depth-1" id="li-comment-98">
		<article id="comment-98" class="comment">
			<footer class="comment-meta">
				<div class="comment-author vcard">
					<img alt='' src='http://0.gravatar.com/avatar/ad516503a11cd5ca435acc9bb6523536?s=68' class='avatar avatar-68 photo avatar-default' height='68' width='68' /><span class="fn">Anonymous</span> on <a href="comment-page-1/index.html#comment-98"><time pubdate datetime="2007-09-04T08:21:00+00:00">September 4, 2007 at 8:21 AM</time></a> <span class="says">said:</span>
									</div><!-- .comment-author .vcard -->

				
			</footer>

			<div class="comment-content"><p>You might also be interested in PAMIE &#8212; google python pamie to find it.  It is a complete library for manipulating IE.</p>
</div>

			<div class="reply">
							</div><!-- .reply -->
		</article><!-- #comment-## -->

	</li>
		</ol>

		
	
									<div id="respond">
				<h3 id="reply-title">Leave a Reply <small><a rel="nofollow" id="cancel-comment-reply-link" href="index.html#respond" style="display:none;">Cancel reply</a></small></h3>
									<form action="http://ohadpr.com/wp-comments-post.php" method="post" id="commentform">
																			<p class="comment-notes">Your email address will not be published. Required fields are marked <span class="required">*</span></p>							<p class="comment-form-author"><label for="author">Name</label> <span class="required">*</span><input id="author" name="author" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-email"><label for="email">Email</label> <span class="required">*</span><input id="email" name="email" type="text" value="" size="30" aria-required='true' /></p>
<p class="comment-form-url"><label for="url">Website</label><input id="url" name="url" type="text" value="" size="30" /></p>
												<p class="comment-form-comment"><label for="comment">Comment</label><textarea id="comment" name="comment" cols="45" rows="8" aria-required="true"></textarea></p>						<p class="form-allowed-tags">You may use these <abbr title="HyperText Markup Language">HTML</abbr> tags and attributes:  <code>&lt;a href=&quot;&quot; title=&quot;&quot;&gt; &lt;abbr title=&quot;&quot;&gt; &lt;acronym title=&quot;&quot;&gt; &lt;b&gt; &lt;blockquote cite=&quot;&quot;&gt; &lt;cite&gt; &lt;code&gt; &lt;del datetime=&quot;&quot;&gt; &lt;em&gt; &lt;i&gt; &lt;q cite=&quot;&quot;&gt; &lt;strike&gt; &lt;strong&gt; </code></p>						<p class="form-submit">
							<input name="submit" type="submit" id="submit" value="Post Comment" />
							<input type='hidden' name='comment_post_ID' value='13' id='comment_post_ID' />
<input type='hidden' name='comment_parent' id='comment_parent' value='0' />
						</p>
						<p style="display: none;"><input type="hidden" id="akismet_comment_nonce" name="akismet_comment_nonce" value="c73e8d52da" /></p>					</form>
							</div><!-- #respond -->
						
</div><!-- #comments -->

				
			</div><!-- #content -->
		</div><!-- #primary -->


	</div><!-- #main -->

	<footer id="colophon" role="contentinfo">

			

			<div id="site-generator">
								<a href="http://wordpress.org/" title="Semantic Personal Publishing Platform" rel="generator">Proudly powered by WordPress</a>
			</div>
	</footer><!-- #colophon -->
</div><!-- #page -->


</body>
</html>
<!-- Localized -->